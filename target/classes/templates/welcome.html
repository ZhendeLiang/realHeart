<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>Love In China</title>

		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="apple-touch-icon" href="apple-touch-icon.png">

		<link rel="stylesheet" href="/welcome/css/bootstrap.min.css">
		<link rel="stylesheet" href="/welcome/css/bootstrap-theme.min.css">
		<link rel="stylesheet" href="/welcome/css/fontAwesome.css">
		<link rel="stylesheet" href="/welcome/css/light-box.css">
		<link rel="stylesheet" href="/welcome/css/templatemo-main.css">
		<link href="/welcome/css/css.css" rel="stylesheet">

		<script src="/welcome/js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
	</head>

	<body>

		<div class="sequence">

			<div class="seq-preloader">
				<svg width="39" height="16" viewBox="0 0 39 16" xmlns="http://www.w3.org/2000/svg" class="seq-preload-indicator">
					<g fill="#F96D38">
						<path class="seq-preload-circle seq-preload-circle-1" d="M3.999 12.012c2.209 0 3.999-1.791 3.999-3.999s-1.79-3.999-3.999-3.999-3.999 1.791-3.999 3.999 1.79 3.999 3.999 3.999z" />
						<path class="seq-preload-circle seq-preload-circle-2" d="M15.996 13.468c3.018 0 5.465-2.447 5.465-5.466 0-3.018-2.447-5.465-5.465-5.465-3.019 0-5.466 2.447-5.466 5.465 0 3.019 2.447 5.466 5.466 5.466z" />
						<path class="seq-preload-circle seq-preload-circle-3" d="M31.322 15.334c4.049 0 7.332-3.282 7.332-7.332 0-4.049-3.282-7.332-7.332-7.332s-7.332 3.283-7.332 7.332c0 4.05 3.283 7.332 7.332 7.332z" />
					</g>
				</svg>
			</div>

		</div>

		<nav>
			<div class="logo">
				<img src="/welcome/img/ui.png" alt="">
			</div>
			<div class="mini-logo">
				<img src="/welcome/img/ui.png" alt="">
			</div>
			<ul>
				<li>
					<a href="#1"><i class="fa fa-home"></i> <em>首页</em></a>
				</li>
				<li>
					<a href="#2"><i class="fa fa-user"></i> <em>个人详情</em></a>
				</li>
				<li>
					<a href="#3"><i class="fa fa-group"></i> <em>好友列表</em></a>
				</li>
				<li>
					<a href="#4"><i class="fa fa-heart"></i> <em>在线交友</em></a>
				</li>
				<li>
					<a href="#5"><i class="fa fa-signal"></i> <em>等级提升</em></a>
				</li>
			</ul>
		</nav>

		<div class="slides">
			<!--个人主页-->
			<div class="slide" id="1">
				<div class="content first-content">
					<div class="container-fluid">
						<div class="col-md-3">
							<div class="author-image"><img th:src="${userHeadImg}" src="/welcome/img/author_image.png" alt=""></div>
						</div>
						<div class="col-md-9">
							<h2 th:text="${userInfo.username}">用户名</h2>
							<h4 th:text="${userInfo.nickname}">昵称</h4>
							<p th:text="${userInfo.selfIntroduction}">个人简介<em>为空哦</em></p>
							<div class="main-btn">
								<a data-toggle="modal" data-target="#editAccountInformation">完善帐号信息</a>
							</div>
							<div class="fb-btn">
								<a data-toggle="modal" data-target="#changeHeadImgAndBackground">修改头像/背景</a>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="slide" id="2">
				<div class="content second-content">
					<div class="container-fluid">
						<div class="col-md-6">
							<div class="left-content">
								<h2>个人详情</h2>
								<!-- <p>Please tell your friends about templatemo website. A variety of free CSS templates are available for immediate downloads.</p>
								<p>Phasellus vitae faucibus orci. Etiam eleifend orci sed faucibus semper. Cras varius dolor et augue fringilla, eu commodo sapien iaculis. Donec eget dictum tellus.
									<a href="#">Curabitur</a> a interdum diam. Nulla vestibulum porttitor porta.</p>
								<p>Nulla vitae interdum libero, vel posuere ipsum. Phasellus interdum est et dapibus tempus. Vestibulum malesuada lorem condimentum mauris ornare dapibus. Curabitur tempor ligula et
									<a href="#">placerat</a> molestie.</p>
								<p>Aliquam efficitur eu purus in interdum.
									<a href="#">Etiam tincidunt</a> magna ex, sit amet lobortis felis bibendum id. Lorem ipsum dolor sit amet, consectetur adipiscing elit. </p>
								<div class="main-btn">
									<a href="#3">Read More</a>
								</div> -->
								<div class="main-btn">
									<div class="col-md-6">
										<a href="#3">姓名:</a><p style="display: inline-block; margin-left: 20px;" th:text="${userInfo.username}"></p>
									</div>
									<div class="col-md-6">
										<a href="#3">昵称:</a><p style="display: inline-block; margin-left: 20px;" th:text="${userInfo.nickname}"></p>
									</div>
								</div>
								<div class="main-btn">
									<div class="col-md-6">
										<a href="#3">性别:</a>
										<p style="display: inline-block; margin-left: 20px;" th:if=" ${userInfo.gender} == '0'">女</p>
										<p style="display: inline-block; margin-left: 20px;" th:if=" ${userInfo.gender} == '1'">男</p>
									</div>
									<div class="col-md-6">
										<a href="#3">邮箱:</a><p style="display: inline-block; margin-left: 20px;" th:text="${userInfo.email}"></p>
									</div>
								</div>
								<div class="main-btn">
									<div class="col-md-6">
										<a href="#3">手机号:</a><p style="display: inline-block; margin-left: 20px;" th:text="${userInfo.phoneNumber}"></p>
									</div>
									<div class="col-md-6">
										<a href="#3">身份证:</a><p style="display: inline-block; margin-left: 20px;" th:text="${userInfo.idCard}"></p>
									</div>
								</div>
								<div class="main-btn">
									<a href="#3">创建时间:</a><p style="display: inline-block; margin-left: 20px;" th:text="${userInfo.createTime}"></p>
								</div>
								<div class="main-btn">
									<a href="#3">个人简介:</a>
									<fieldset>
										<textarea th:text="${userInfo.selfIntroduction}" name="message" rows="6" class="form-control" id="message" placeholder="Your message..." required=""></textarea>
									</fieldset>
								</div>
							</div>
						</div>
						<div class="col-md-2" th:each="img:${userBackgroundImgs}">
							<div class="detailsDiv"><a th:href="${img}" target="_blank" href="#"><img class="col-xs-2 col-sm-2 col-md-2" th:src="${img}" src=""/></a></div>
						</div>
					</div>
				</div>
			</div>

			<div class="slide" id="3">
				<div class="content third-content">
					<div class="container-fluid">
					</div>
				</div>
			</div>
			<div class="slide" id="4">
				<div class="content fourth-content">
					<div class="container-fluid">
						<iframe src="heartbeat?pageNum=1&pageSize=10" id="iframepage" frameborder="0" scrolling="no" 
							marginheight="0" marginwidth="0" onLoad="iFrameHeight()" width="100%" height="800"></iframe>
					</div>
				</div>
			</div>
			<div class="slide" id="5">
				<div class="content fifth-content">
					<div class="container-fluid">
						<div class="col-md-6">

						</div>
						<div class="col-md-6">
							<form id="contact" action="" method="post">
								<div class="row">
									<div class="col-md-12">
										<fieldset>
											<input name="name" type="text" class="form-control" id="name" placeholder="Your name..." required="">
										</fieldset>
									</div>
									<div class="col-md-12">
										<fieldset>
											<input name="email" type="email" class="form-control" id="email" placeholder="Your email..." required="">
										</fieldset>
									</div>
									<div class="col-md-12">
										<fieldset>
											<input name="subject" type="text" class="form-control" id="subject" placeholder="Subject..." required="">
										</fieldset>
									</div>
									<div class="col-md-12">
										<fieldset>
											<textarea name="message" rows="6" class="form-control" id="message" placeholder="Your message..." required></textarea>
										</fieldset>
									</div>
									<div class="col-md-12">
										<fieldset>
											<button type="submit" id="form-submit" class="btn">Send Now</button>
										</fieldset>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="footer">
			<div class="content">
				<p>Copyright &copy; 2018 Your Company .
					<a href="#">Moonlight</a> by
					<a href="#" target="_parent">HTML5 Max</a>
				</p>
				<p>More Templates
				</p>
			</div>
		</div>

		<!--完善个人信息模态框（Modal）-->
		<div class="modal fade" id="editAccountInformation" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog" style="width:700px;">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
							&times;
						</button>
						<h4 class="modal-title" id="updateModalLabel">
							完善个人信息
						</h4>
					</div>
					<div class="modal-body">
						<form class="form-horizontal" role="form" id="updateForm">
							<div class="form-group">
								<label for="updateUsername" class="col-sm-2 control-label">用户名</label>
								<div class="col-sm-10">
									<input type="text" class="form-control" id="updateUsername" 
										   placeholder="请输入用户名" th:value="${userInfo.username}" readonly="readonly">
								</div>
							</div>
							<div class="form-group">
								<label for="updateNickname" class="col-sm-2 control-label">昵称</label>
								<div class="col-sm-10">
									<input type="text" class="form-control" id="updateNickname" 
										   placeholder="请输入昵称" th:value="${userInfo.nickname}">
								</div>
							</div>
							<div class="form-group">
								<label for="updatePhoneNumber" class="col-sm-2 control-label">手机号</label>
								<div class="col-sm-10">
									<input type="text" class="form-control" id="updatePhoneNumber" 
										   placeholder="请输入手机号" th:value="${userInfo.phoneNumber}">
								</div>
							</div>
							<div class="form-group">
								<label for="updateEmail" class="col-sm-2 control-label">邮箱</label>
								<div class="col-sm-10">
									<input type="text" class="form-control" id="updateEmail" 
										   placeholder="请输入邮箱" th:value="${userInfo.email}">
								</div>
							</div>
							<div class="form-group">
								<label for="updateIdCard" class="col-sm-2 control-label">身份证</label>
								<div class="col-sm-10">
									<input type="text" class="form-control" id="updateIdCard" 
										   placeholder="请输入身份证" th:value="${userInfo.idCard}">
								</div>
							</div>
							
							<div class="form-group">
								<label for="gender" class="col-sm-2 control-label">身份证</label>
								<div class="col-sm-10">
									<select id="updateGender" class="form-control">
										<option value="1" th:selected="${userInfo.gender=='1'}">男</option>
        								<option value="0" th:selected="${userInfo.gender=='0'}">女</option>
									</select>
								</div>
							</div>
							
							<div class="form-group">
								<label for="gender" class="col-sm-2 control-label">个人简介</label>
								<div class="col-sm-10">
									<textarea id="updateSelfIntroduction" class="form-control" rows="3" th:text="${userInfo.selfIntroduction}">
									</textarea>
								</div>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button id="closeUpdateUser" type="button" class="btn btn-default" data-dismiss="modal">关闭
						</button>
						<button id="submitUpdateUser" type="button" class="btn btn-primary">
							提交更改
						</button>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal -->
		</div>

		<!--修改头像/背景 模态框（Modal）-->
		<div class="modal fade" id="changeHeadImgAndBackground" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog" style="width:800px;">
				<div class="modal-content">
					<div class="modal-header">
						<button id="closeUploadImgModalLabel" type="button" class="close" data-dismiss="modal" aria-hidden="true">
							&times;
						</button>
						<h4 class="modal-title" id="uploadImgModalLabel">
							修改头像/背景
						</h4>
					</div>
					<div class="modal-body">
						<iframe  th:src="${uploadImageAndParams}" src="uploadImage?type=1" id="iframepage" frameborder="0" scrolling="yes" 
							marginheight="0" marginwidth="0" onLoad="iFrameHeight()" width="100%" height="680"></iframe>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal -->
		</div>
		<div>
			<input name="backgroundImgs" type="hidden" th:each="img:${userBackgroundImgs}" th:value="${img}">
		</div>

		<script src="/welcome/js/vendor/jquery-1.11.2.min.js"></script>
		<script>
			window.jQuery || document.write('<script src="/welcome/js/vendor/jquery-1.11.2.min.js"><\/script>')
		</script>
		<script src="/welcome/js/vendor/bootstrap.min.js"></script>
		<script src="/welcome/js/datepicker.js"></script>
		<script src="/welcome/js/plugins.js"></script>
		<script src="/welcome/js/main.js"></script>

		<script th:inline="javascript">
			$(document).ready(function() {
				// navigation click actions 
				$('.scroll-link').on('click', function(event) {
					event.preventDefault();
					var sectionID = $(this).attr("data-id");
					scrollToID('#' + sectionID, 750);
				});
				// scroll to top action
				$('.scroll-top').on('click', function(event) {
					event.preventDefault();
					$('html, body').animate({
						scrollTop: 0
					}, 'slow');
				});
				// mobile nav toggle
				$('#nav-toggle').on('click', function(event) {
					event.preventDefault();
					$('#main-nav').toggleClass("open");
				});
				
				var imgs = $("input[name='backgroundImgs']");
				$.each(imgs,function(i,item){
					var num = i+1;
					if(num<=5){
						$(".slides .slide:nth-child("+num+")").css("background-image","url(" + item.value + ")");
					}
				});
				
				$('#submitUpdateUser').on('click', function(event) {
					var username = $("#updateUsername").val();
					var nickname = $("#updateNickname").val();
					var phoneNumber = $("#updatePhoneNumber").val();
					var email = $("#updateEmail").val();
					var idCard = $("#updateIdCard").val();
					var gender = $("#updateGender").val();
					var selfIntroduction = $("#updateSelfIntroduction").val();
					$.ajax({
			            url: '/filter/json/userInfo',
			            type: 'put',
			            dataType: 'json',
			            async: false,
			            data: {
			            	nickname:nickname,
			            	phoneNumber:phoneNumber,
			            	email:email,
			            	idCard:idCard,
			            	gender:gender,
			            	selfIntroduction:selfIntroduction,
			            	type:"user"
			            	},
			            success:function(data){
			                if (data.code == '0') {
								showPopover($('#updateModalLabel'),"更新用户成功,刷新后起效");
			                } else {
			                	
			                }
			            },
			            error:function(){
			            	status = false;
			                // return false;
			            }
			        });
				});
				
				function showPopover(target, msg) {
				    target.attr("data-original-title", msg);
				    $('[data-toggle="tooltip"]').tooltip();
				    target.tooltip('show');
				    target.focus();

				    //2秒后消失提示框
				    var id = setTimeout(
				        function () {
				            target.attr("data-original-title", "");
				            target.tooltip('hide');
				            document.getElementById("closeUpdateUser").click();
				        }, 2000
				    );
				}
			});
			// scroll function
			function scrollToID(id, speed) {
				var offSet = 0;
				var targetOffset = $(id).offset().top - offSet;
				var mainNav = $('#main-nav');
				$('html,body').animate({
					scrollTop: targetOffset
				}, speed);
				if(mainNav.hasClass("open")) {
					mainNav.css("height", "1px").removeClass("in").addClass("collapse");
					mainNav.removeClass("open");
				}
			}
			if(typeof console === "undefined") {
				console = {
					log: function() {}
				};
			}
		</script>
	</body>

</html>